<!DOCTYPE html>
<html>
  <head>
    <title>Yet Another Color Picker</title>
    <style>
    body { 
      text-align: center;
    }
    table {
      text-align: left;
      margin:0 auto 0 auto;
    }
    td {
      vertical-align: center;
      width:50px;
      height:50px;
    }
    input {
      width:30px;
      margin-top:8px;
      border:1px solid black;
    }
    #footer {
      text-align: center;
      font-size:80%;
      color:#333;
    }
    </style>
  </head>
  <body>
    <table cellspacing=1>
      <tr>
        <td id='dv1'/>
        <td id='dv2' class='box'/>
        <td id='dv3' class='box'/>
        <td id='dv4' class='box'/>
        <td id='dv5' class='box'/>
        <td id='l1' class='box'/>
        <td id='l2' class='box'/>
        <td id='l3' class='box'/>
        <td id='ds1' class='box'/>
        <td id='ds2' class='box'/>
        <td id='ds3' class='box'/>
        <td id='ds4' class='box'/>
        <td id='ds5' class='box'/>
      </tr>
      <tr>
        <td id='dv6' class='box'/>
        <td id='dv7' class='box'/>
        <td id='dv8' class='box'/>
        <td id='dv9' class='box'/>
        <td id='dv10' class='box'/>
        <td id='l4' class='box'/>
        <td id='l5' class='box'/>
        <td id='l6' class='box'/>
        <td id='ds6' class='box'/>
        <td id='ds7' class='box'/>
        <td id='ds8' class='box'/>
        <td id='ds9' class='box'/>
        <td id='ds10' class='box'/>
      </tr>
      <tr>
        <td id='dv11' class='box'/>
        <td id='dv12' class='box'/>
        <td id='dv13' class='box'/>
        <td id='dv14' class='box'/>
        <td id='dv15' class='box'/>
        <td id='l7' class='box'/>
        <td id='l8' class='box'/>
        <td id='l9' class='box'/>
        <td id='ds11' class='box'/>
        <td id='ds12' class='box'/>
        <td id='ds13' class='box'/>
        <td id='ds14' class='box'/>
        <td id='ds15' class='box'/>
      </tr>

      <tr>
        <td id='m1' class='box'/>
        <td id='m2' class='box'/>
        <td id='m3' class='box'/>
        <td id='m4' class='box'/>
        <td id='m5' class='box'/>
        <td id='c' colspan=3 rowspan=3 style='padding:0.5em'>
          # <input id="hex" style="width:60px"></input><br />
          h <input id="h"/>&nbsp;r <input id="r"/><br />
          s <input id="s"/>&nbsp;g <input id="g"/><br />
          v <input id="v"/>&nbsp;b <input id="b"/><br />
        </td>
        <td id='m6' class='box'/>
        <td id='m7' class='box'/>
        <td id='m8' class='box'/>
        <td id='m9' class='box'/>
        <td id='m10' class='box'/>
      </tr>
      <tr>
        <td id='m11' class='box'/>
        <td id='m12' class='box'/>
        <td id='m13' class='box'/>
        <td id='m14' class='box'/>
        <td id='m15' class='box'/>
        <td id='m16' class='box'/>
        <td id='m17' class='box'/>
        <td id='m18' class='box'/>
        <td id='m19' class='box'/>
        <td id='m20' class='box'/>
      </tr>
      <tr>
        <td id='m21' class='box'/>
        <td id='m22' class='box'/>
        <td id='m23' class='box'/>
        <td id='m24' class='box'/>
        <td id='m25' class='box'/>
        <td id='m26' class='box'/>
        <td id='m27' class='box'/>
        <td id='m28' class='box'/>
        <td id='m29' class='box'/>
        <td id='m30' class='box'/>
      </tr>
      <tr>
        <td id='dh1' class='box'/>
        <td id='dh2' class='box'/>
        <td id='dh3' class='box'/>
        <td id='dh4' class='box'/>
        <td id='dh5' class='box'/>
        <td id='dh6' class='box'/>
        <td id='dh7' class='box'/>
        <td id='dh8' class='box'/>
        <td id='dh9' class='box'/>
        <td id='dh10' class='box'/>
        <td id='dh11' class='box'/>
        <td id='dh12' class='box'/>
        <td id='dh13' class='box'/>
      </tr>
      <tr>
        <td id='dh14' class='box'/>
        <td id='dh15' class='box'/>
        <td id='dh16' class='box'/>
        <td id='dh17' class='box'/>
        <td id='dh18' class='box'/>
        <td id='dh19' class='box'/>
        <td id='dh20' class='box'/>
        <td id='dh21' class='box'/>
        <td id='dh22' class='box'/>
        <td id='dh23' class='box'/>
        <td id='dh24' class='box'/>
        <td id='dh25' class='box'/>
        <td id='dh26' class='box'/>
      </tr>
      <tr>
        <td id='dh27' class='box'/>
        <td id='dh28' class='box'/>
        <td id='dh29' class='box'/>
        <td id='dh30' class='box'/>
        <td id='dh31' class='box'/>
        <td id='dh32' class='box'/>
        <td id='dh33' class='box'/>
        <td id='dh34' class='box'/>
        <td id='dh35' class='box'/>
        <td id='dh36' class='box'/>
        <td id='dh37' class='box'/>
        <td id='dh38' class='box'/>
        <td id='dh39' class='box'/>
      </tr>
      <tr>
        <td id='c1' class='box'/>
        <td id='c2' class='box'/>
        <td id='c3' class='box'/>
        <td id='c4' class='box'/>
        <td id='c5' class='box'/>
        <td id='c6' class='box'/>
        <td id='c7' class='box'/>
        <td id='c8' class='box'/>
        <td id='c9' class='box'/>
        <td id='c10' class='box'/>
        <td id='c11' class='box'/>
        <td id='c12' class='box'/>
        <td id='c13' class='box'/>
      </tr>
      <tr>
        <td id='p1' class='box'/>
        <td id='p2' class='box'/>
        <td id='p3' class='box'/>
        <td id='p4' class='box'/>
        <td id='p5' class='box'/>
        <td id='p6' class='box'/>
        <td id='p7' class='box'/>
        <td id='p8' class='box'/>
        <td id='p9' class='box'/>
        <td id='p10' class='box'/>
        <td id='p11' class='box'/>
        <td id='p12' class='box'/>
        <td id='p13' class='box'/>
      </tr>
    </table>
    <div id='footer'><a href='https://github.com/trystan/YetAnotherColorPicker.com'>GitHub project</a> &middot; Trystan Spangler &middot; 2013</div>

    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
      //from http://stackoverflow.com/questions/190560/jquery-animate-backgroundcolor
      (function(d){d.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(f,e){d.fx.step[e]=function(g){if(!g.colorInit){g.start=c(g.elem,e);g.end=b(g.end);g.colorInit=true}g.elem.style[e]="rgb("+[Math.max(Math.min(parseInt((g.pos*(g.end[0]-g.start[0]))+g.start[0]),255),0),Math.max(Math.min(parseInt((g.pos*(g.end[1]-g.start[1]))+g.start[1]),255),0),Math.max(Math.min(parseInt((g.pos*(g.end[2]-g.start[2]))+g.start[2]),255),0)].join(",")+")"}});function b(f){var e;if(f&&f.constructor==Array&&f.length==3){return f}if(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(f)){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}if(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(f)){return[parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55]}if(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(f)){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}if(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(f)){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}if(e=/rgba\(0, 0, 0, 0\)/.exec(f)){return a.transparent}return a[d.trim(f).toLowerCase()]}function c(g,e){var f;do{f=d.css(g,e);if(f!=""&&f!="transparent"||d.nodeName(g,"body")){break}e="backgroundColor"}while(g=g.parentNode);return b(f)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]}})(jQuery);
      function hex(c) {
          var h = c.toString(16);
          return h.length == 1 ? "0" + h : h;
      }
      function rgb(r, g, b) {
          return "#" + hex(r) + hex(g) + hex(b);
      }
      function rgb_f(r, g, b){
        return rgb(Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255));
      }
      function rgbToHsv(r, g, b){
        r = r / 255;
        g = g / 255;
        b = b / 255;
        var max = Math.max(r, g, b)
        var min = Math.min(r, g, b);
        var h, s, v = max;

        var d = max - min;
        s = max == 0 ? 0 : d / max;

        if (max == min)
            h = 0;
        else {
            switch (max){
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return [h, s, v];
      }
      function hsv(h, s, v) {
        var i, f, p, q, t;
        if(s == 0) 
          return rgb_f(v,v,v);
        
        h = h / 60;
        i = Math.floor(h);
        f = h - i;
        p = v * (1 - s);
        q = v * (1 - s * f);
        t = v * (1 - s * (1 - f));
        switch(i) {
          case 0: return rgb_f(v,t,p);
          case 1: return rgb_f(q,v,p);
          case 2: return rgb_f(p,v,t);
          case 3: return rgb_f(p,q,v);
          case 4: return rgb_f(t,p,v);
          case 5: return rgb_f(v,p,q);
        }
      }
      var isEven = true;
      var ph, ps, pv, h, s, v;
      var speed = 200;
      function recolor(h0, s0, v0){
        ph = h;
        ps = s;
        pv = v;

        h = Math.round(Math.max(0,Math.min(h0,360)));
        s = Math.round(Math.max(0,Math.min(s0*100,100))) / 100;
        v = Math.round(Math.max(0,Math.min(v0*100,100))) / 100;

        var s1 = 0.2;
        var s2 = 0.9;
        var v1 = 0.5;
        var v2 = 0.9;

        $("#c").animate({ backgroundColor: hsv(h, s, v) }, speed);
        $("#c input").animate({ backgroundColor: hsv(h, s, v) }, speed);
        if (v < 0.5)
          $("#c, #c input").animate({ color: "#eeeeee", border:"#ffffff" }, speed);
        else
          $("#c, #c input").animate({ color: "#111111", border:"#000000" }, speed);

        $("#hex").val(hsv(h, s, v).substring(1,7).toUpperCase());
        $("#h").val(h);
        $("#s").val(Math.round(s * 100));
        $("#v").val(Math.round(v * 100));

        var rgb = hexToRgb($("#hex").val());
        $("#r").val(rgb[0]);
        $("#g").val(rgb[1]);
        $("#b").val(rgb[2]);

        // different value
        for (var i = 1; i < 16; i++)
        {
          var c = hsv(h, s, i/16);
          $("#dv" + i).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // different saturation
        for (var i = 1; i < 16; i++)
        {
          var c = hsv(h, i/16, v);
          $("#ds" + i).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // different hue
        for (var i = 1; i < 40; i++)
        {
          var c = hsv(i/40 * 360, (0.75 + s) / 2, (0.75 + v) / 2);
          $("#dh" + i).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to black, gray, white
        for (var row = 0; row < 3; row++)
        for (var col = 0; col < 3; col++)
        {
          var from = (col+1)/4 * 255;
          var amount = [0.8,0.5,0.2][row];
          var id = "#l" + (row * 3 + col + 1);
          var c = lerp_rgb(from, rgb[0], from, rgb[1], from, rgb[2], amount);
          $(id).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        var size = 5;
        var size0 = size + 1;

        // lerp to red
        for (var i = 1; i < size0; i++)
        {
          var c = lerp_rgb(rgb[0], 255, rgb[1], 0, rgb[2], 0, i/size0);
          $("#m" + (0*size+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }
        // lerp to anti-red
        for (var i = 1; i < size0; i++)
        {
          var c = lerp_rgb(0, rgb[0], 128, rgb[1], 255, rgb[2], i/size0);
          $("#m" + (1*size+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to orange
        for (var i = 1; i < size0; i++)
        {
          var c = lerp_rgb(rgb[0], 230, rgb[1], 115, rgb[2], 0, i/size0);
          $("#m" + (2*size+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }
        // lerp to anti-orange
        for (var i = 1; i < size0; i++)
        {
          var c = lerp_rgb(43, rgb[0], 0, rgb[1], 255, rgb[2], i/size0);
          $("#m" + (3*size+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to yellow
        for (var i = 1; i < size0; i++)
        {
          var c = lerp_rgb(rgb[0], 255, rgb[1], 255, rgb[2], 0, i/size0);
          $("#m" + (4*size+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }
        // lerp to anti-yellow
        for (var i = 1; i < size0; i++)
        {
          var c = lerp_rgb(128, rgb[0], 0, rgb[1], 255, rgb[2], i/size0);
          $("#m" + (5*size+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to previous color
        var prgb = hexToRgb(hsv(ph, ps, pv).substring(1,7).toUpperCase());
        if (isEven)
        {
          for (var i = 1; i < 14; i++) {
            var c = lerp_rgb(rgb[0], prgb[0], rgb[1], prgb[1], rgb[2], prgb[2], i/10);
            $("#c" + i).animate({ backgroundColor: c }, speed).attr("title", c);
          }
        }
        else
        {
          for (var i = 1; i < 14; i++) {
            var c = lerp_rgb(prgb[0], rgb[0], prgb[1], rgb[1], prgb[2], rgb[2], i/10);
            $("#c" + i).animate({ backgroundColor: c }, speed).attr("title", c);
          }
        }
        isEven = !isEven;

        // add current color
        var added = false;
        for (var i = 1; i < 14 && added == false; i++) {
          if ($("#p" + i).css("backgroundColor") == "transparent")
          {
            $("#p" + i).css("backgroundColor", hsv(h, s, v));
            added = true;
            break;
          }
        }
        if (!added) {
          for (var i = 1; i < 9; i++)
            $("#p" + i).css("backgroundColor", $("#p" + (i+1)).css("backgroundColor"));
          $("#p9").css("backgroundColor", hsv(h, s, v));
        }
      }
      function lerp(v1, v2, p) {
        return v1 * p + v2 * (1 - p);
      }
      function lerp_rgb(r1, r2, g1, g2, b1, b2, p) {
        return rgb_f(lerp(r1, r2, p)/255,lerp(g1, g2, p)/255,lerp(b1, b2, p)/255);
      }
      function setLocation(c) {
        window.location.href = window.location.href.split("#")[0] + c;
      }
      function fromLocation(){ 
        h = Math.random() * 360;
        s = Math.random() * 0.5 + 0.25;
        v = Math.random() * 0.5 + 0.25;
        var c = window.location.href.split("#")[1];
        if (c == undefined)
          recolor(Math.random() * 360, Math.random() * 0.5 + 0.25, Math.random() * 0.5 + 0.25);
        else
        {
          c = (c.replace(/[^0-9a-f]/g,"") + "000000").substring(0,6);
          var rgb = hexToRgb(c);
          var hsv = rgbToHsv(rgb[0], rgb[1], rgb[2]);
          recolor(hsv[0] * 360, hsv[1], hsv[2]);
        }
      }
      function hexToRgb(hex){
          var r = parseInt(hex.substring(0,2),16);
          var g = parseInt(hex.substring(2,4),16);
          var b = parseInt(hex.substring(4,6),16);
          return [r, g, b];
      }
      function splitRgb(rgb){
          var r = rgb.split(",")[0].replace(/[^0-9]/g,"");
          var g = rgb.split(",")[1].replace(/[^0-9]/g,"");
          var b = rgb.split(",")[2].replace(/[^0-9]/g,"");
          return [r, g, b];
      }
      $(function (){
        fromLocation();

        $(".box").on('click', function(){
          var rgb = splitRgb($(this).css('backgroundColor'))
          var components = rgbToHsv(rgb[0], rgb[1], rgb[2]);
          setLocation(hsv(components[0] * 360, components[1], components[2]));
          recolor(components[0] * 360, components[1], components[2]);
        });
        $("#hex").on('blur', function(){
          $(this).val(($(this).val().replace(/[^0-9a-f]/g,"") + "000000").substring(0,6));
          var rgb = hexToRgb($(this).val());
          var components = rgbToHsv(rgb[0], rgb[1], rgb[2]);
          recolor(components[0] * 360, components[1], components[2])
        });
        $("#h").on('blur', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(0 + $(this).val(), s, v);
        });
        $("#s").on('blur', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(h, (0 + $(this).val()) / 100, v);
        });
        $("#v").on('blur', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(h, s, (0 + $(this).val()) / 100);
        });
        $("#r,#g,#b").on('blur', function(){
          $(this).val((0 + $(this).val().replace(/[^0-9]/g,"")) * 1);
          var hsv = rgbToHsv($("#r").val(), $("#g").val(), $("#b").val())
          recolor(hsv[0] * 360, hsv[1], hsv[2]);
        });
      });
    </script>
  </body>
</html>
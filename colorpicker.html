<!DOCTYPE html>
<html>
  <head>
    <title>Yet Another Color Picker</title>
    <style>
    body { 
      text-align: center;
    }
    #boxes {
      text-align: left;
      width:484px;
      margin:0 auto 0 auto;
    }
    .box {
      border:0;
      padding:0;
      margin:-1px;
      width:50px;
      height:50px;
      display:inline-block;
    }
    .big-box {
      border:0;
      padding:0;
      margin:-1px;
      float:right;
      width:154px;
      height:154px;
      display:inline-block;
    }
    .big-box input {
      width:30px;
      margin-top:8px;
      border:1px solid black;
    }
    #footer {
      text-align: center;
      font-size:80%;
      color:#333;
    }
    </style>
  </head>
  <body>
    <div id="boxes">
      <div id='dv1' class="box"></div>
      <div id='dv2' class="box"></div>
      <div id='dv3' class="box"></div>
      <div id='l1' class="box"></div>
      <div id='l2' class="box"></div>
      <div id='l3' class="box"></div>
      <div id='ds1' class="box"></div>
      <div id='ds2' class="box"></div>
      <div id='ds3' class="box"></div>

      <div id='dv4' class="box"></div>
      <div id='dv5' class="box"></div>
      <div id='dv6' class="box"></div>
      <div id='l4' class="box"></div>
      <div id='l5' class="box"></div>
      <div id='l6' class="box"></div>
      <div id='ds4' class="box"></div>
      <div id='ds5' class="box"></div>
      <div id='ds6' class="box"></div>

      <div id='dv7' class="box"></div>
      <div id='dv8' class="box"></div>
      <div id='dv9' class="box"></div>
      <div id='l7' class="box"></div>
      <div id='l8' class="box"></div>
      <div id='l9' class="box"></div>
      <div id='ds7' class="box"></div>
      <div id='ds8' class="box"></div>
      <div id='ds9' class="box"></div>

      <div class="big-box" style="margin-right:18px">
        <div id='m4' class="box"></div>
        <div id='m5' class="box"></div>
        <div id='m6' class="box"></div>

        <div id='m10' class="box"></div>
        <div id='m11' class="box"></div>
        <div id='m12' class="box"></div>

        <div id='m16' class="box"></div>
        <div id='m17' class="box"></div>
        <div id='m18' class="box"></div>
      </div>

      <div id='c' class="big-box" style="margin-right:4px">
        &nbsp;&nbsp;# <input id="hex" style="width:60px"></input><br />
        &nbsp;&nbsp;h <input id="h"/>&nbsp;&nbsp;&nbsp;r <input id="r"/><br />
        &nbsp;&nbsp;s <input id="s"/>&nbsp;&nbsp;&nbsp;g <input id="g"/><br />
        &nbsp;&nbsp;v <input id="v"/>&nbsp;&nbsp;&nbsp;b <input id="b"/><br />
      </div>

      <div id='m1' class="box"></div>
      <div id='m2' class="box"></div>
      <div id='m3' class="box"></div>

      <div id='m7' class="box"></div>
      <div id='m8' class="box"></div>
      <div id='m9' class="box"></div>

      <div id='m13' class="box"></div>
      <div id='m14' class="box"></div>
      <div id='m15' class="box"></div>

      <div id='dh1' class="box"></div>
      <div id='dh2' class="box"></div>
      <div id='dh3' class="box"></div>
      <div id='dh4' class="box"></div>
      <div id='dh5' class="box"></div>
      <div id='dh6' class="box"></div>
      <div id='dh7' class="box"></div>
      <div id='dh8' class="box"></div>
      <div id='dh9' class="box"></div>

      <div id='dh10' class="box"></div>
      <div id='dh11' class="box"></div>
      <div id='dh12' class="box"></div>
      <div id='dh13' class="box"></div>
      <div id='dh14' class="box"></div>
      <div id='dh15' class="box"></div>
      <div id='dh16' class="box"></div>
      <div id='dh17' class="box"></div>
      <div id='dh18' class="box"></div>

      <div id='dh19' class="box"></div>
      <div id='dh20' class="box"></div>
      <div id='dh21' class="box"></div>
      <div id='dh22' class="box"></div>
      <div id='dh23' class="box"></div>
      <div id='dh24' class="box"></div>
      <div id='dh25' class="box"></div>
      <div id='dh26' class="box"></div>
      <div id='dh27' class="box"></div>


      <div id='c1' class="box"></div>
      <div id='c2' class="box"></div>
      <div id='c3' class="box"></div>
      <div id='c4' class="box"></div>
      <div id='c5' class="box"></div>
      <div id='c6' class="box"></div>
      <div id='c7' class="box"></div>
      <div id='c8' class="box"></div>
      <div id='c9' class="box"></div>

      <div id='p1' class="box"></div>
      <div id='p2' class="box"></div>
      <div id='p3' class="box"></div>
      <div id='p4' class="box"></div>
      <div id='p5' class="box"></div>
      <div id='p6' class="box"></div>
      <div id='p7' class="box"></div>
      <div id='p8' class="box"></div>
      <div id='p9' class="box"></div>
    </div>
    <div id='footer'><a href='https://github.com/trystan/YetAnotherColorPicker.com'>GitHub project</a> &middot; Trystan Spangler &middot; 2013</div>

    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
      //from http://stackoverflow.com/questions/190560/jquery-animate-backgroundcolor
      (function(d){d.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(f,e){d.fx.step[e]=function(g){if(!g.colorInit){g.start=c(g.elem,e);g.end=b(g.end);g.colorInit=true}g.elem.style[e]="rgb("+[Math.max(Math.min(parseInt((g.pos*(g.end[0]-g.start[0]))+g.start[0]),255),0),Math.max(Math.min(parseInt((g.pos*(g.end[1]-g.start[1]))+g.start[1]),255),0),Math.max(Math.min(parseInt((g.pos*(g.end[2]-g.start[2]))+g.start[2]),255),0)].join(",")+")"}});function b(f){var e;if(f&&f.constructor==Array&&f.length==3){return f}if(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(f)){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}if(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(f)){return[parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55]}if(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(f)){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}if(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(f)){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}if(e=/rgba\(0, 0, 0, 0\)/.exec(f)){return a.transparent}return a[d.trim(f).toLowerCase()]}function c(g,e){var f;do{f=d.css(g,e);if(f!=""&&f!="transparent"||d.nodeName(g,"body")){break}e="backgroundColor"}while(g=g.parentNode);return b(f)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]}})(jQuery);
      function hex(c) {
          var h = c.toString(16);
          return h.length == 1 ? "0" + h : h;
      }
      function rgb(r, g, b) {
          return "#" + hex(r) + hex(g) + hex(b);
      }
      function rgb_f(r, g, b){
        return rgb(Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255));
      }
      function rgbToHsv(r, g, b){
        r = r / 255;
        g = g / 255;
        b = b / 255;
        var max = Math.max(r, g, b)
        var min = Math.min(r, g, b);
        var h, s, v = max;

        var d = max - min;
        s = max == 0 ? 0 : d / max;

        if (max == min)
            h = 0;
        else {
            switch (max){
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return [h, s, v];
      }
      function hsv(h, s, v) {
        var i, f, p, q, t;
        if(s == 0) 
          return rgb_f(v,v,v);
        
        h = h / 60;
        i = Math.floor(h);
        f = h - i;
        p = v * (1 - s);
        q = v * (1 - s * f);
        t = v * (1 - s * (1 - f));
        switch(i) {
          case 0: return rgb_f(v,t,p);
          case 1: return rgb_f(q,v,p);
          case 2: return rgb_f(p,v,t);
          case 3: return rgb_f(p,q,v);
          case 4: return rgb_f(t,p,v);
          case 5: return rgb_f(v,p,q);
        }
      }
      var isEven = true;
      var ph, ps, pv, h, s, v;
      var speed = 200;
      function recolor(h0, s0, v0){
        ph = h;
        ps = s;
        pv = v;

        h = Math.round(Math.max(0,Math.min(h0,360)));
        s = Math.round(Math.max(0,Math.min(s0*100,100))) / 100;
        v = Math.round(Math.max(0,Math.min(v0*100,100))) / 100;

        var s1 = 0.2;
        var s2 = 0.9;
        var v1 = 0.5;
        var v2 = 0.9;

        $("#c").animate({ backgroundColor: hsv(h, s, v) }, speed);
        $("#c input").animate({ backgroundColor: hsv(h, s, v) }, speed);
        if (v < 0.5)
          $("#c, #c input").animate({ color: "#eeeeee", border:"#ffffff" }, speed);
        else
          $("#c, #c input").animate({ color: "#111111", border:"#000000" }, speed);

        $("#hex").val(hsv(h, s, v).substring(1,7).toUpperCase());
        $("#h").val(h);
        $("#s").val(Math.round(s * 100));
        $("#v").val(Math.round(v * 100));

        var rgb = hexToRgb($("#hex").val());
        $("#r").val(rgb[0]);
        $("#g").val(rgb[1]);
        $("#b").val(rgb[2]);

        // different value
        for (var i = 1; i < 10; i++)
        {
          var c = hsv(h, s, i/10);
          $("#dv" + i).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // different saturation
        for (var i = 1; i < 10; i++)
        {
          var c = hsv(h, i/10, v);
          $("#ds" + i).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // different hue
        for (var i = 1; i < 28; i++)
        {
          var c = hsv(i/28 * 360, (0.75 + s) / 2, (0.75 + v) / 2);
          $("#dh" + i).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to black, gray, white
        for (var row = 0; row < 3; row++)
        for (var col = 0; col < 3; col++)
        {
          var from = (col+1)/4 * 255;
          var amount = [0.8,0.5,0.2][row];
          var id = "#l" + (row * 3 + col + 1);
          var c = lerp_rgb(from, rgb[0], from, rgb[1], from, rgb[2], amount);
          $(id).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to red
        for (var i = 1; i < 4; i++)
        {
          var c = lerp_rgb(rgb[0], 255, rgb[1], 0, rgb[2], 0, i/4);
          $("#m" + i).animate({ backgroundColor: c }, speed).attr("title", c);
        }
        // lerp to anti-red
        for (var i = 1; i < 4; i++)
        {
          var c = lerp_rgb(0, rgb[0], 128, rgb[1], 255, rgb[2], i/4);
          $("#m" + (3+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to orange
        for (var i = 1; i < 4; i++)
        {
          var c = lerp_rgb(rgb[0], 230, rgb[1], 115, rgb[2], 0, i/4);
          $("#m" + (6+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }
        // lerp to anti-orange
        for (var i = 1; i < 4; i++)
        {
          var c = lerp_rgb(43, rgb[0], 0, rgb[1], 255, rgb[2], i/4);
          $("#m" + (9+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to yellow
        for (var i = 1; i < 4; i++)
        {
          var c = lerp_rgb(rgb[0], 255, rgb[1], 255, rgb[2], 0, i/4);
          $("#m" + (12+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }
        // lerp to anti-yellow
        for (var i = 1; i < 4; i++)
        {
          var c = lerp_rgb(128, rgb[0], 0, rgb[1], 255, rgb[2], i/4);
          $("#m" + (15+i)).animate({ backgroundColor: c }, speed).attr("title", c);
        }

        // lerp to previous color
        var prgb = hexToRgb(hsv(ph, ps, pv).substring(1,7).toUpperCase());
        if (isEven)
        {
          for (var i = 1; i < 10; i++) {
            var c = lerp_rgb(rgb[0], prgb[0], rgb[1], prgb[1], rgb[2], prgb[2], i/10);
            $("#c" + i).animate({ backgroundColor: c }, speed).attr("title", c);
          }
        }
        else
        {
          for (var i = 1; i < 10; i++) {
            var c = lerp_rgb(prgb[0], rgb[0], prgb[1], rgb[1], prgb[2], rgb[2], i/10);
            $("#c" + i).animate({ backgroundColor: c }, speed).attr("title", c);
          }
        }
        isEven = !isEven;

        // add current color
        var added = false
        for (var i = 1; i < 10 && added == false; i++) {
          if ($("#p" + i).css("backgroundColor") == "transparent")
          {
            $("#p" + i).css("backgroundColor", hsv(h, s, v));
            added = true;
          } else if ($("#p" + i).css("backgroundColor") == hsv(h, s, v)) {
            added = true;
          }
        }
        if (!added) {
          for (var i = 1; i < 9; i++)
            $("#p" + i).css("backgroundColor", $("#p" + (i+1)).css("backgroundColor"));
          $("#p9").css("backgroundColor", hsv(h, s, v));
        }
      }
      function lerp(v1, v2, p) {
        return v1 * p + v2 * (1 - p);
      }
      function lerp_rgb(r1, r2, g1, g2, b1, b2, p) {
        return rgb_f(lerp(r1, r2, p)/255,lerp(g1, g2, p)/255,lerp(b1, b2, p)/255);
      }
      function setLocation(c) {
        window.location.href = window.location.href.split("#")[0] + c;
      }
      function fromLocation(){ 
        h = Math.random() * 360;
        s = Math.random() * 0.5 + 0.25;
        v = Math.random() * 0.5 + 0.25;
        var c = window.location.href.split("#")[1];
        if (c == undefined)
          recolor(Math.random() * 360, Math.random() * 0.5 + 0.25, Math.random() * 0.5 + 0.25);
        else
        {
          c = (c.replace(/[^0-9a-f]/g,"") + "000000").substring(0,6);
          var rgb = hexToRgb(c);
          var hsv = rgbToHsv(rgb[0], rgb[1], rgb[2]);
          recolor(hsv[0] * 360, hsv[1], hsv[2]);
        }
      }
      function hexToRgb(hex){
          var r = parseInt(hex.substring(0,2),16);
          var g = parseInt(hex.substring(2,4),16);
          var b = parseInt(hex.substring(4,6),16);
          return [r, g, b];
      }
      function splitRgb(rgb){
          var r = rgb.split(",")[0].replace(/[^0-9]/g,"");
          var g = rgb.split(",")[1].replace(/[^0-9]/g,"");
          var b = rgb.split(",")[2].replace(/[^0-9]/g,"");
          return [r, g, b];
      }
      $(function (){
        fromLocation();

        $(".box").on('click', function(){
          var rgb = splitRgb($(this).css('backgroundColor'))
          var components = rgbToHsv(rgb[0], rgb[1], rgb[2]);
          setLocation(hsv(components[0] * 360, components[1], components[2]));
          recolor(components[0] * 360, components[1], components[2]);
        });
        $("#hex").on('blur', function(){
          $(this).val(($(this).val().replace(/[^0-9a-f]/g,"") + "000000").substring(0,6));
          var rgb = hexToRgb($(this).val());
          var components = rgbToHsv(rgb[0], rgb[1], rgb[2]);
          recolor(components[0] * 360, components[1], components[2])
        });
        $("#h").on('blur', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(0 + $(this).val(), s, v);
        });
        $("#s").on('blur', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(h, (0 + $(this).val()) / 100, v);
        });
        $("#v").on('blur', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(h, s, (0 + $(this).val()) / 100);
        });
        $("#r,#g,#b").on('blur', function(){
          $(this).val((0 + $(this).val().replace(/[^0-9]/g,"")) * 1);
          var hsv = rgbToHsv($("#r").val(), $("#g").val(), $("#b").val())
          recolor(hsv[0] * 360, hsv[1], hsv[2]);
        });
      });
    </script>
  </body>
</html>
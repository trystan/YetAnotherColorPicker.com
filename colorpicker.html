<!DOCTYPE html>
<html>
  <head>
    <title>Yet Another Color Picker</title>
    <style>
    body { 
      text-align: center;
    }
    #boxes {
      text-align: left;
      width:500px;
      height:550px;
      margin:0 auto 0 auto;
    }
    .box {
      border:0;
      padding:0;
      margin:0;
      width:50px;
      height:50px;
      display:inline-block;
    }
    .big-box {
      border:0;
      padding:0;
      margin:0;
      float:right;
      width:158px;
      height:158px;
      display:inline-block;
    }
    .big-box input {
      width:60px;
      margin-top:8px;
    }
    #footer {
      text-align: center;
      font-size:80%;
      color:#333;
    }
    </style>
  </head>
  <body>
    <div id="boxes">
      <div id='h1' class="box"></div>
      <div id='h2' class="box"></div>
      <div id='h3' class="box"></div>
      <div id='s1' class="box"></div>
      <div id='s2' class="box"></div>
      <div id='s3' class="box"></div>
      <div id='s10' class="box"></div>
      <div id='s11' class="box"></div>
      <div id='s12' class="box"></div>

      <div id='h4' class="box"></div>
      <div id='h5' class="box"></div>
      <div id='h6' class="box"></div>
      <div id='s4' class="box"></div>
      <div id='s5' class="box"></div>
      <div id='s6' class="box"></div>
      <div id='s13' class="box"></div>
      <div id='s14' class="box"></div>
      <div id='s15' class="box"></div>

      <div id='h7' class="box"></div>
      <div id='h8' class="box"></div>
      <div id='h9' class="box"></div>
      <div id='s7' class="box"></div>
      <div id='s8' class="box"></div>
      <div id='s9' class="box"></div>
      <div id='s16' class="box"></div>
      <div id='s17' class="box"></div>
      <div id='s18' class="box"></div>

      <div class="big-box" style='margin-right:18px;'>
            # <input id="hex"></input><br />
            h <input id="h"></input><br />
            s <input id="s"></input><br />
            v <input id="v"></input>
      </div>
      <div id='c' class="big-box" style="margin-right:4px;"></div>

      <div id='h10' class="box"></div>
      <div id='h11' class="box"></div>
      <div id='h12' class="box"></div>

      <div id='h13' class="box"></div>
      <div id='h14' class="box"></div>
      <div id='h15' class="box"></div>

      <div id='h16' class="box"></div>
      <div id='h17' class="box"></div>
      <div id='h18' class="box"></div>
      
      <div id='v1' class="box"></div>
      <div id='v2' class="box"></div>
      <div id='v3' class="box"></div>
      <div id='v10' class="box"></div>
      <div id='v11' class="box"></div>
      <div id='v12' class="box"></div>
      <div id='c1' class="box"></div>
      <div id='c2' class="box"></div>
      <div id='c3' class="box"></div>

      <div id='v4' class="box"></div>
      <div id='v5' class="box"></div>
      <div id='v6' class="box"></div>
      <div id='v13' class="box"></div>
      <div id='v14' class="box"></div>
      <div id='v15' class="box"></div>
      <div id='c4' class="box"></div>
      <div id='c5' class="box"></div>
      <div id='c6' class="box"></div>

      <div id='v7' class="box"></div>
      <div id='v8' class="box"></div>
      <div id='v9' class="box"></div>
      <div id='v16' class="box"></div>
      <div id='v17' class="box"></div>
      <div id='v18' class="box"></div>
      <div id='c7' class="box"></div>
      <div id='c8' class="box"></div>
      <div id='c9' class="box"></div>
    </div>
    <div id='footer'><a href='https://github.com/trystan/YetAnotherColorPicker.com'>GitHub project</a> &middot; Trystan Spangler &middot; 2013</div>

    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script>
      //from http://stackoverflow.com/questions/190560/jquery-animate-backgroundcolor
      (function(d){d.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(f,e){d.fx.step[e]=function(g){if(!g.colorInit){g.start=c(g.elem,e);g.end=b(g.end);g.colorInit=true}g.elem.style[e]="rgb("+[Math.max(Math.min(parseInt((g.pos*(g.end[0]-g.start[0]))+g.start[0]),255),0),Math.max(Math.min(parseInt((g.pos*(g.end[1]-g.start[1]))+g.start[1]),255),0),Math.max(Math.min(parseInt((g.pos*(g.end[2]-g.start[2]))+g.start[2]),255),0)].join(",")+")"}});function b(f){var e;if(f&&f.constructor==Array&&f.length==3){return f}if(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(f)){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}if(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(f)){return[parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55]}if(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(f)){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}if(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(f)){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}if(e=/rgba\(0, 0, 0, 0\)/.exec(f)){return a.transparent}return a[d.trim(f).toLowerCase()]}function c(g,e){var f;do{f=d.css(g,e);if(f!=""&&f!="transparent"||d.nodeName(g,"body")){break}e="backgroundColor"}while(g=g.parentNode);return b(f)}var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]}})(jQuery);
      function hex(c) {
          var h = c.toString(16);
          return h.length == 1 ? "0" + h : h;
      }
      function rgb(r, g, b) {
          return "#" + hex(r) + hex(g) + hex(b);
      }
      function rgb_f(r, g, b){
        return rgb(Math.floor(r * 255), Math.floor(g * 255), Math.floor(b * 255));
      }
      function rgbToHsv(r, g, b){
        r = r / 255;
        g = g / 255;
        b = b / 255;
        var max = Math.max(r, g, b)
        var min = Math.min(r, g, b);
        var h, s, v = max;

        var d = max - min;
        s = max == 0 ? 0 : d / max;

        if (max == min)
            h = 0;
        else {
            switch (max){
                case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                case g: h = (b - r) / d + 2; break;
                case b: h = (r - g) / d + 4; break;
            }
            h /= 6;
        }
        return [h, s, v];
      }
      function hsv(h, s, v) {
        h = h % 360;
        s = ((s * 100) % 100) / 100;
        v = ((v * 100) % 100) / 100;
        var i, f, p, q, t;
        if(s == 0) 
          return rgb_f(v,v,v);
        
        h = h / 60;
        i = Math.floor(h);
        f = h - i;
        p = v * (1 - s);
        q = v * (1 - s * f);
        t = v * (1 - s * (1 - f));
        switch(i) {
          case 0: return rgb_f(v,t,p);
          case 1: return rgb_f(q,v,p);
          case 2: return rgb_f(p,v,t);
          case 3: return rgb_f(p,q,v);
          case 4: return rgb_f(t,p,v);
          case 5: return rgb_f(v,p,q);
        }
      }
      var isEven = true;
      var ph, ps, pv, h, s, v;
      var speed = 200;
      function recolor(h0, s0, v0){
        ph = h;
        ps = s;
        pv = v;

        h = Math.round(Math.max(0,Math.min(h0,360)));
        s = Math.round(Math.max(0,Math.min(s0*100,100))) / 100;
        v = Math.round(Math.max(0,Math.min(v0*100,100))) / 100;

        var s1 = 0.2;
        var s2 = 0.9;
        var v1 = 0.5;
        var v2 = 0.9;

        $("#c").animate({ backgroundColor: hsv(h, s, v) }, speed);
        $("#hex").val(hsv(h, s, v).substring(1,7).toUpperCase());
        $("#h").val(h);
        $("#s").val(s * 100);
        $("#v").val(v * 100);

        for (var i = 1; i < 19; i++)
          $("#h" + i).animate({ backgroundColor: hsv((270 + i * 16) % 360, s, v) }, speed).attr("title", hsv((270 + i * 16) % 360, s, v));
        for (var i = 1; i < 10; i++)
          $("#s" + i).animate({ backgroundColor: hsv(h, i * 0.1, v1) }, speed).attr("title", hsv(h, i * 0.1, v1));
        for (var i = 1; i < 10; i++)
          $("#s" + (i+9)).animate({ backgroundColor: hsv(h, i * 0.1, v2) }, speed).attr("title", hsv(h, i * 0.1, v2));
        for (var i = 1; i < 10; i++)
          $("#v" + i).animate({ backgroundColor: hsv(h, s1, i * 0.1) }, speed).attr("title", hsv(h, s1, i * 0.1));
        for (var i = 1; i < 10; i++)
          $("#v" + (i+9)).animate({ backgroundColor: hsv(h, s2, i * 0.1) }, speed).attr("title", hsv(h, s2, i * 0.1));

        if (isEven)
        {
          for (var i = 1; i < 10; i++) {
            var c = hsv(lerp(ph, h, i/10), lerp(ps, s, i/10), lerp(pv, v, i/10));
            $("#c" + i).animate({ backgroundColor: c }, speed).attr("title", c);
          }
        }
        else
        {
          for (var i = 1; i < 10; i++) {
            var c = hsv(lerp(h, ph, i/10), lerp(s, ps, i/10), lerp(v, pv, i/10));
            $("#c" + i).animate({ backgroundColor: c }, speed).attr("title", c);
          }
        }
        isEven = !isEven;
      }
      function lerp(v1, v2, p) {
        return v1 * p + v2 * (1 - p);
      }
      function setLocation(c) {
        window.location.href = window.location.href.split("#")[0] + c;
      }
      function fromLocation(){ 
        h = Math.random() * 360;
        s = Math.random() * 0.5 + 0.25;
        v = Math.random() * 0.5 + 0.25;
        var c = window.location.href.split("#")[1];
        if (c == undefined)
          recolor(Math.random() * 360, Math.random() * 0.5 + 0.25, Math.random() * 0.5 + 0.25);
        else
        {
          c = (c.replace(/[^0-9a-f]/g,"") + "000000").substring(0,6);
          var r = parseInt(c.substring(0,2),16);
          var g = parseInt(c.substring(2,4),16);
          var b = parseInt(c.substring(4,6),16);
          var hsv = rgbToHsv(r, g, b);
          recolor(hsv[0] * 360, hsv[1], hsv[2]);
        }
      }
      $(function (){
        fromLocation();

        $(".box").on('click', function(){
          var bg = $(this).css('backgroundColor');
          var r = bg.split(",")[0].replace(/[^0-9]/g,"");
          var g = bg.split(",")[1].replace(/[^0-9]/g,"");
          var b = bg.split(",")[2].replace(/[^0-9]/g,"");
          var components = rgbToHsv(r, g, b);
          setLocation(hsv(components[0] * 360, components[1], components[2]));
          recolor(components[0] * 360, components[1], components[2]);
        });
        $("#rgb").on('keyup', function(){
          $(this).val(($(this).val().replace(/[^0-9a-f]/g,"") + "000000").substring(0,6));
          var r = $(this).val().substring(0,2);
          var g = $(this).val().substring(2,4);
          var b = $(this).val().substring(4,6);
          var components = rgbToHsv(r, g, b);
          recolor(components[0] * 360, components[1], components[2])
        });
        $("#h").on('keyup', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(0 + $(this).val(), s, v);
        });
        $("#s").on('keyup', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(h, (0 + $(this).val()) / 100, v);
        });
        $("#v").on('keyup', function(){
          $(this).val($(this).val().replace(/[^0-9]/g,""));
          recolor(h, s, (0 + $(this).val()) / 100);
        });
      });
    </script>
  </body>
</html>